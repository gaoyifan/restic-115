# 授权码模式

本模式建议开发者服务端参与授权

![1743573228269-a3515415-927f-49f6-863b-782330e177f4.png](./img/Pc2HnhIcgJRbt__j/1743573228269-a3515415-927f-49f6-863b-782330e177f4-110814.png)



基础域名：[https://passportapi.115.com](https://passportapi.115.com)

## 授权码方式请求授权
### 基本信息
**Path：** /open/authorize

**Method：** GET

**接口描述：**

用户未登录情况下，会重定向到登录页面。  
用户在已登录情况下，会自动完成授权并重定向到 redirect_uri 指定的地址

### 请求参数
**Query**

| 参数名称 | 是否必须 | 示例 | 备注 |
| --- | --- | --- | --- |
| client_id | 是 |  | APP ID |
| redirect_uri | 是 | https://foo.com/bar | 授权成功后重定向到指定的地址(记得要urlencode处理一下)并附上授权码 code，如果本接口有传 state 参数，会附带到重定向地址去。重定向地址的域名，需要先到 [https://open.115.com/](https://open.115.com/) 应用管理应用域名设置 |
| response_type | 是 | code | 授权模式，固定 为code, 表示授权码模式 |
| state | 否 | 123456 | 随机值，会通过 redirect_uri 原样返回，防止CSRF攻击，强烈建议开发者带上并在请求 换取access_token 接口之前验证 state 是否一致 |


### 返回数据（接口调用失败时候返回）
| 名称 | 类型 | 是否必须 | 默认值 | 备注 | 其他信息 |
| --- | --- | --- | --- | --- | --- |
|  state | number | 非必须 | | 0.失败；1.成功 | |
|  code | number | 非必须 | | | |
|  errno | number | 非必须 | | | |
|  data | object | 非必须 | | | |
|  message | string | 非必须 | | | |
|  error | string | 非必须 | | | |


## 用授权码换取 access_token
### 基本信息
**Path：** /open/authCodeToToken

**Method：** POST

**接口描述：**

<font style="color:#DF2A3F;">强烈建议在</font>**<font style="color:#DF2A3F;">服务端</font>**<font style="color:#DF2A3F;">请求本接口</font>，防止 <font style="color:rgb(57, 56, 56);">APP Secret 泄露！</font>

### 请求参数
**Headers**

| 参数名称 | 参数值 | 是否必须 | 示例 | 备注 |
| --- | --- | --- | --- | --- |
| Content-Type | application/x-www-form-urlencoded | 是 |  |  |


 **Body**

| 参数名称 | 参数类型 | 是否必须 | 示例 | 备注 |
| --- | --- | --- | --- | --- |
| client_id | text | 是 |  | APP ID |
| client_secret | text | 是 |  | APP Secret |
| code | text | 是 |  | 授权码，/open/authCodeToToken 重定向地址里面 |
| redirect_uri | text | 是 | [https://foo.com?state=123456](https://foo.com?state=123456) | 与 /open/authCodeToToken 传的 redirect_uri 一致，防 MITM, CSRF |
| grant_type | text | 是 | authorization_code | 授权类型，固定 为 authorization_code, 表示授权码类型 |


### 返回数据
| 名称 | 类型 | 是否必须 | 默认值 | 备注 | 其他信息 |
| --- | --- | --- | --- | --- | --- |
|  state | number | 非必须 | | 0.失败；1.成功 | |
|  code | number | 非必须 | | | |
|  message | string | 非必须 | | | |
|  data | object | 非必须 | | | |
| <font style="color:#8c8a8a;">├─</font> access_token | string | 非必须 | | 用于访问资源接口的凭证 | |
| <font style="color:#8c8a8a;">├─</font> refresh_token | string | 非必须 | | 用于刷新 access_token，有效期1年 | |
| <font style="color:#8c8a8a;">├─</font> expires_in | number | 非必须 | | access_token 有效期，单位秒 | mock: 7200 |
|  error | string | 非必须 | | | |
|  errno | number | 非必须 | | | |




> 更新: 2025-04-03 13:50:56  
> 原文: <https://www.yuque.com/115yun/open/okr2cq0wywelscpe>